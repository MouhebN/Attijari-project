# Configuration Oracle 21 pour Spring Boot

## üîß Probl√®mes Identifi√©s

1. **ORA-28000: Compte verrouill√©** - Le compte RUYA est verrouill√©
2. **Configuration de base de donn√©es** - Besoin de cr√©er et configurer le sch√©ma

## üöÄ Solutions

### √âtape 1: D√©verrouiller le compte RUYA

Connectez-vous √† Oracle en tant qu'administrateur (SYSTEM) :

```sql
-- Se connecter en tant que SYSTEM
CONNECT SYSTEM/root@localhost:1521/XEPDB1

-- D√©verrouiller le compte RUYA
ALTER USER RUYA ACCOUNT UNLOCK;

-- R√©initialiser le mot de passe si n√©cessaire
ALTER USER RUYA IDENTIFIED BY ruya123;

-- Donner les privil√®ges n√©cessaires
GRANT CONNECT, RESOURCE, DBA TO RUYA;
GRANT CREATE SESSION TO RUYA;
GRANT UNLIMITED TABLESPACE TO RUYA;

-- V√©rifier que le compte est d√©verrouill√©
SELECT username, account_status FROM dba_users WHERE username = 'RUYA';
```

### √âtape 2: Cr√©er le sch√©ma et les tables

```sql
-- Se connecter en tant que RUYA
CONNECT RUYA/ruya123@localhost:1521/XEPDB1

-- Cr√©er les tables n√©cessaires (exemple)
CREATE TABLE users (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    username VARCHAR2(50) UNIQUE NOT NULL,
    email VARCHAR2(100) UNIQUE NOT NULL,
    password VARCHAR2(255) NOT NULL,
    created_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Cr√©er d'autres tables selon vos entit√©s...
```

### √âtape 3: V√©rifier la configuration Oracle

1. **V√©rifier que le service XEPDB1 est actif**
   ```sql
   SELECT name, open_mode FROM v$database;
   SELECT name, open_mode FROM v$pdbs;
   ```

2. **V√©rifier le listener**
   ```bash
   lsnrctl status
   ```

3. **Tester la connexion**
   ```bash
   sqlplus RUYA/ruya123@localhost:1521/XEPDB1
   ```

### √âtape 4: Configuration Spring Boot pour Oracle

Le fichier `application.properties` est d√©j√† configur√© correctement :

```properties
spring.datasource.url=jdbc:oracle:thin:@localhost:1521/XEPDB1
spring.datasource.username=RUYA
spring.datasource.password=ruya123
spring.datasource.driver-class-name=oracle.jdbc.OracleDriver
spring.jpa.database-platform=org.hibernate.dialect.OracleDialect
```

### √âtape 5: D√©marrer l'application

1. **Avec le profil par d√©faut (Oracle)**
   ```bash
   mvn spring-boot:run
   ```

2. **Ou depuis IntelliJ** (apr√®s avoir configur√© les variables d'environnement)

## üîç Diagnostic

### V√©rifier les logs de connexion

Apr√®s le d√©marrage, vous devriez voir :
```
=== SPRING PROFILES DEBUG ===
Active profiles: default
Default profiles: default
Database URL: jdbc:oracle:thin:@localhost:1521/XEPDB1
Database Driver: oracle.jdbc.OracleDriver
=================================
```

### Commandes utiles Oracle

```sql
-- V√©rifier les sessions actives
SELECT username, machine, program FROM v$session WHERE username IS NOT NULL;

-- V√©rifier les verrous
SELECT * FROM v$locked_object;

-- V√©rifier l'espace de tables
SELECT tablespace_name, bytes/1024/1024 MB FROM dba_data_files;
```

## üö® En cas de probl√®me

1. **Red√©marrer Oracle Database**
2. **V√©rifier les logs Oracle** : `alert_<SID>.log`
3. **V√©rifier la connectivit√© r√©seau** : `telnet localhost 1521`
4. **Utiliser H2 en attendant** : `-Dspring.profiles.active=h2` 